{"version":3,"names":["React","StyleSheet","useWindowDimensions","View","PagerView","Animated","runOnJS","runOnUI","useAnimatedReaction","useAnimatedStyle","useDerivedValue","useSharedValue","withDelay","withTiming","Context","TabNameContext","Lazy","MaterialTabBar","TABBAR_HEIGHT","Tab","IS_IOS","ONE_FRAME_MS","scrollToImpl","useAnimatedDynamicRefs","useContainerRef","usePageScrollHandler","useTabProps","AnimatedPagerView","createAnimatedComponent","Container","memo","forwardRef","ref","initialTabName","headerHeight","initialHeaderHeight","minHeaderHeight","tabBarHeight","initialTabBarHeight","revealHeaderOnScroll","snapThreshold","children","renderHeader","renderTabBar","props","headerContainerStyle","cancelTranslation","containerStyle","lazy","cancelLazyFadeIn","pagerProps","onIndexChange","onTabChange","width","customWidth","allowHeaderOverscroll","raw","containerRef","tabProps","tabNamesArray","refMap","setRef","windowWidth","containerHeight","undefined","contentInset","value","snappingTo","offset","accScrollY","oldAccScrollY","accDiffClamp","scrollYCurrent","scrollY","map","contentHeights","tabNames","index","findIndex","n","data","setData","useState","useEffect","focusedTab","calculateNextOffset","headerScrollDistance","indexDecimal","afterRender","duration","resyncTabScroll","name","trigger","nextIndex","Math","round","propagateTabChange","useCallback","change","i","prevIndex","prevTabName","tabName","_current","prev","headerTranslateY","min","stylez","transform","translateY","getHeaderHeight","event","height","nativeEvent","layout","getTabBarHeight","onLayout","onTabPress","current","setPage","length","pageScrollHandler","onPageScroll","e","position","useImperativeHandle","setIndex","jumpToTab","getFocusedTab","getCurrentIndex","styles","container","topContainer","headerContainer","tabBarContainer","style","absoluteFill","Children","toArray","create","flex","zIndex","backgroundColor","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation"],"sources":["Container.tsx"],"sourcesContent":["import React from 'react'\nimport {\n  LayoutChangeEvent,\n  StyleSheet,\n  useWindowDimensions,\n  View,\n} from 'react-native'\nimport PagerView from 'react-native-pager-view'\nimport Animated, {\n  runOnJS,\n  runOnUI,\n  useAnimatedReaction,\n  useAnimatedStyle,\n  useDerivedValue,\n  useSharedValue,\n  withDelay,\n  withTiming,\n} from 'react-native-reanimated'\n\nimport { Context, TabNameContext } from './Context'\nimport { Lazy } from './Lazy'\nimport { MaterialTabBar, TABBAR_HEIGHT } from './MaterialTabBar'\nimport { Tab } from './Tab'\nimport { IS_IOS, ONE_FRAME_MS, scrollToImpl } from './helpers'\nimport {\n  useAnimatedDynamicRefs,\n  useContainerRef,\n  usePageScrollHandler,\n  useTabProps,\n} from './hooks'\nimport {\n  CollapsibleProps,\n  CollapsibleRef,\n  ContextType,\n  IndexChangeEventData,\n  TabName,\n} from './types'\n\nconst AnimatedPagerView = Animated.createAnimatedComponent(PagerView)\n\n/**\n * Basic usage looks like this:\n *\n * ```tsx\n * import { Tabs } from 'react-native-collapsible-tab-view'\n *\n * const Example = () => {\n *   return (\n *     <Tabs.Container renderHeader={MyHeader}>\n *       <Tabs.Tab name=\"A\">\n *         <ScreenA />\n *       </Tabs.Tab>\n *       <Tabs.Tab name=\"B\">\n *         <ScreenB />\n *       </Tabs.Tab>\n *     </Tabs.Container>\n *   )\n * }\n * ```\n */\nexport const Container = React.memo(\n  React.forwardRef<CollapsibleRef, CollapsibleProps>(\n    (\n      {\n        initialTabName,\n        headerHeight: initialHeaderHeight,\n        minHeaderHeight = 0,\n        tabBarHeight: initialTabBarHeight = TABBAR_HEIGHT,\n        revealHeaderOnScroll = false,\n        snapThreshold,\n        children,\n        renderHeader,\n        renderTabBar = (props) => <MaterialTabBar {...props} />,\n        headerContainerStyle,\n        cancelTranslation,\n        containerStyle,\n        lazy,\n        cancelLazyFadeIn,\n        pagerProps,\n        onIndexChange,\n        onTabChange,\n        width: customWidth,\n        allowHeaderOverscroll,\n        raw,\n      },\n      ref\n    ) => {\n      const containerRef = useContainerRef()\n\n      const [tabProps, tabNamesArray] = useTabProps(children, Tab)\n\n      const [refMap, setRef] = useAnimatedDynamicRefs()\n\n      const windowWidth = useWindowDimensions().width\n      const width = customWidth ?? windowWidth\n\n      const containerHeight = useSharedValue<number | undefined>(undefined)\n\n      const tabBarHeight = useSharedValue<number | undefined>(\n        initialTabBarHeight\n      )\n\n      const headerHeight = useSharedValue<number | undefined>(\n        !renderHeader ? 0 : initialHeaderHeight\n      )\n\n      const contentInset = useDerivedValue(() => {\n        if (allowHeaderOverscroll) return 0\n\n        // necessary for the refresh control on iOS to be positioned underneath the header\n        // this also adjusts the scroll bars to clamp underneath the header area\n        return IS_IOS\n          ? (headerHeight.value || 0) + (tabBarHeight.value || 0)\n          : 0\n      })\n\n      const snappingTo: ContextType['snappingTo'] = useSharedValue(0)\n      const offset: ContextType['offset'] = useSharedValue(0)\n      const accScrollY: ContextType['accScrollY'] = useSharedValue(0)\n      const oldAccScrollY: ContextType['oldAccScrollY'] = useSharedValue(0)\n      const accDiffClamp: ContextType['accDiffClamp'] = useSharedValue(0)\n      const scrollYCurrent: ContextType['scrollYCurrent'] = useSharedValue(0)\n      const scrollY: ContextType['scrollY'] = useSharedValue(\n        tabNamesArray.map(() => 0)\n      )\n\n      const contentHeights: ContextType['contentHeights'] = useSharedValue(\n        tabNamesArray.map(() => 0)\n      )\n\n      const tabNames: ContextType['tabNames'] = useDerivedValue<TabName[]>(\n        () => tabNamesArray,\n        [tabNamesArray]\n      )\n      const index: ContextType['index'] = useSharedValue(\n        initialTabName\n          ? tabNames.value.findIndex((n) => n === initialTabName)\n          : 0\n      )\n\n      const [data, setData] = React.useState(tabNamesArray)\n\n      React.useEffect(() => {\n        setData(tabNamesArray)\n      }, [tabNamesArray])\n\n      const focusedTab: ContextType['focusedTab'] = useDerivedValue<TabName>(() => {\n        return tabNames.value[index.value]\n      }, [tabNames])\n      const calculateNextOffset = useSharedValue(index.value)\n      const headerScrollDistance: ContextType['headerScrollDistance'] = useDerivedValue(() => {\n        return headerHeight.value !== undefined\n          ? headerHeight.value - minHeaderHeight\n          : 0\n      }, [headerHeight, minHeaderHeight])\n\n      const indexDecimal: ContextType['indexDecimal'] = useSharedValue(\n        index.value\n      )\n\n      const afterRender = useSharedValue(0)\n      React.useEffect(() => {\n        afterRender.value = withDelay(\n          ONE_FRAME_MS * 5,\n          withTiming(1, { duration: 0 })\n        )\n      }, [afterRender, tabNamesArray])\n\n      const resyncTabScroll = () => {\n        'worklet'\n        if (raw) {\n          return\n        }\n        for (const name of tabNamesArray) {\n          scrollToImpl(\n            refMap[name],\n            0,\n            scrollYCurrent.value - contentInset.value,\n            false\n          )\n        }\n      }\n\n      // the purpose of this is to scroll to the proper position if dynamic tabs are changing\n      useAnimatedReaction(\n        () => {\n          return afterRender.value === 1\n        },\n        (trigger) => {\n          if (trigger) {\n            afterRender.value = 0\n            resyncTabScroll()\n          }\n        },\n        [tabNamesArray, refMap, afterRender, contentInset]\n      )\n\n      // derived from scrollX\n      // calculate the next offset and index if swiping\n      // if scrollX changes from tab press,\n      // the same logic must be done, but knowing\n      // the next index in advance\n      useAnimatedReaction(\n        () => {\n          const nextIndex = Math.round(indexDecimal.value)\n          return nextIndex\n        },\n        (nextIndex) => {\n          if (nextIndex !== null && nextIndex !== index.value) {\n            calculateNextOffset.value = nextIndex\n          }\n        },\n        []\n      )\n\n      const propagateTabChange = React.useCallback(\n        (change: IndexChangeEventData<TabName>) => {\n          onTabChange?.(change)\n          onIndexChange?.(change.index)\n        },\n        [onIndexChange, onTabChange]\n      )\n\n      useAnimatedReaction(\n        () => {\n          return calculateNextOffset.value\n        },\n        (i) => {\n          if (i !== index.value) {\n            offset.value =\n              scrollY.value[index.value] - scrollY.value[i] + offset.value\n            runOnJS(propagateTabChange)({\n              prevIndex: index.value,\n              index: i,\n              prevTabName: tabNames.value[index.value],\n              tabName: tabNames.value[i],\n            })\n            index.value = i\n            scrollYCurrent.value = scrollY.value[index.value] || 0\n          }\n        },\n        []\n      )\n\n      useAnimatedReaction(\n        () => headerHeight.value,\n        (_current, prev) => {\n          if (prev === undefined) {\n            // sync scroll if we started with undefined header height\n            resyncTabScroll()\n          }\n        }\n      )\n\n      const headerTranslateY = useDerivedValue(() => {\n        return revealHeaderOnScroll\n          ? -accDiffClamp.value\n          : -Math.min(scrollYCurrent.value, headerScrollDistance.value)\n      }, [revealHeaderOnScroll])\n\n      const stylez = useAnimatedStyle(() => {\n        return {\n          transform: [\n            {\n              translateY: headerTranslateY.value,\n            },\n          ],\n        }\n      }, [revealHeaderOnScroll])\n\n      const getHeaderHeight = React.useCallback(\n        (event: LayoutChangeEvent) => {\n          const height = event.nativeEvent.layout.height\n          if (headerHeight.value !== height) {\n            headerHeight.value = height\n          }\n        },\n        [headerHeight]\n      )\n\n      const getTabBarHeight = React.useCallback(\n        (event: LayoutChangeEvent) => {\n          const height = event.nativeEvent.layout.height\n          if (tabBarHeight.value !== height) tabBarHeight.value = height\n        },\n        [tabBarHeight]\n      )\n\n      const onLayout = React.useCallback(\n        (event: LayoutChangeEvent) => {\n          const height = event.nativeEvent.layout.height\n          if (containerHeight.value !== height) containerHeight.value = height\n        },\n        [containerHeight]\n      )\n\n      const onTabPress = React.useCallback(\n        (name: TabName) => {\n          const i = tabNames.value.findIndex((n) => n === name)\n\n          if (name === focusedTab.value) {\n            const ref = refMap[name]\n            runOnUI(scrollToImpl)(\n              ref,\n              0,\n              headerScrollDistance.value - contentInset.value,\n              true\n            )\n          } else {\n            containerRef.current?.setPage(i)\n          }\n        },\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [containerRef, refMap, contentInset]\n      )\n\n      React.useEffect(() => {\n        if (index.value >= tabNamesArray.length) {\n          onTabPress(tabNamesArray[tabNamesArray.length - 1])\n        }\n      }, [index.value, onTabPress, tabNamesArray])\n\n      const pageScrollHandler = usePageScrollHandler({\n        onPageScroll: (e) => {\n          'worklet'\n          indexDecimal.value = e.position + e.offset\n        },\n      })\n\n      React.useImperativeHandle(\n        ref,\n        () => ({\n          setIndex: (index) => {\n            const name = tabNames.value[index]\n            onTabPress(name)\n            return true\n          },\n          jumpToTab: (name) => {\n            onTabPress(name)\n            return true\n          },\n          getFocusedTab: () => {\n            return tabNames.value[index.value]\n          },\n          getCurrentIndex: () => {\n            return index.value\n          },\n        }),\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        [onTabPress]\n      )\n\n      return (\n        <Context.Provider\n          value={{\n            contentInset,\n            tabBarHeight,\n            headerHeight,\n            refMap,\n            tabNames,\n            index,\n            snapThreshold,\n            revealHeaderOnScroll,\n            focusedTab,\n            accDiffClamp,\n            indexDecimal,\n            containerHeight,\n            scrollYCurrent,\n            scrollY,\n            setRef,\n            headerScrollDistance,\n            accScrollY,\n            oldAccScrollY,\n            offset,\n            snappingTo,\n            contentHeights,\n            headerTranslateY,\n            width,\n            allowHeaderOverscroll,\n          }}\n        >\n          <Animated.View\n            style={[styles.container, { width }, containerStyle]}\n            onLayout={onLayout}\n            pointerEvents=\"box-none\"\n          >\n            <Animated.View\n              pointerEvents=\"box-none\"\n              style={[\n                styles.topContainer,\n                headerContainerStyle,\n                !cancelTranslation && stylez,\n              ]}\n            >\n              <View\n                style={[styles.container, styles.headerContainer]}\n                onLayout={getHeaderHeight}\n                pointerEvents=\"box-none\"\n              >\n                {renderHeader &&\n                  renderHeader({\n                    containerRef,\n                    index,\n                    tabNames: tabNamesArray,\n                    focusedTab,\n                    indexDecimal,\n                    onTabPress,\n                    tabProps,\n                  })}\n              </View>\n              <View\n                style={[styles.container, styles.tabBarContainer]}\n                onLayout={getTabBarHeight}\n                pointerEvents=\"box-none\"\n              >\n                {renderTabBar &&\n                  renderTabBar({\n                    containerRef,\n                    index,\n                    tabNames: tabNamesArray,\n                    focusedTab,\n                    indexDecimal,\n                    width,\n                    onTabPress,\n                    tabProps,\n                  })}\n              </View>\n            </Animated.View>\n\n            <AnimatedPagerView\n              ref={containerRef}\n              onPageScroll={pageScrollHandler}\n              initialPage={index.value}\n              {...pagerProps}\n              style={[pagerProps?.style, StyleSheet.absoluteFill]}\n            >\n              {data.map((tabName, i) => {\n                return (\n                  <View key={i}>\n                    <TabNameContext.Provider value={tabName}>\n                      {lazy ? (\n                        <Lazy\n                          startMounted={i === index.value}\n                          cancelLazyFadeIn={cancelLazyFadeIn}\n                          raw={raw}\n                        >\n                          {\n                            React.Children.toArray(children)[\n                              i\n                            ] as React.ReactElement\n                          }\n                        </Lazy>\n                      ) : (\n                        React.Children.toArray(children)[i]\n                      )}\n                    </TabNameContext.Provider>\n                  </View>\n                )\n              })}\n            </AnimatedPagerView>\n          </Animated.View>\n        </Context.Provider>\n      )\n    }\n  )\n)\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  topContainer: {\n    position: 'absolute',\n    zIndex: 100,\n    width: '100%',\n    backgroundColor: 'white',\n    shadowColor: '#000000',\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.23,\n    shadowRadius: 2.62,\n    elevation: 4,\n  },\n  tabBarContainer: {\n    zIndex: 1,\n  },\n  headerContainer: {\n    zIndex: 2,\n  },\n})\n"],"mappings":"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"}