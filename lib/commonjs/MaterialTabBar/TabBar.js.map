{"version":3,"names":["TABBAR_HEIGHT","MaterialTabBar","tabNames","indexDecimal","scrollEnabled","indicatorStyle","index","TabItemComponent","MaterialTabItem","IndicatorComponent","_IndicatorComponent","getLabelText","name","String","toUpperCase","onTabPress","style","tabProps","contentContainerStyle","labelStyle","inactiveColor","activeColor","tabStyle","width","customWidth","keepActiveTabCentered","tabBarRef","windowWidth","isFirstRender","React","useRef","itemLayoutGathering","Map","tabsOffset","isScrolling","nTabs","length","itemsLayout","setItemsLayout","useState","map","_","i","tabWidth","x","useEffect","current","onTabItemLayout","event","nativeEvent","layout","set","Array","from","entries","filter","tabName","includes","sort","a","b","cancelNextScrollSync","value","onScroll","contentOffset","onBeginDrag","onMomentumEnd","currentIndexToSync","targetIndexToSync","nextIndex","canSync","halfTab","offset","styles","contentContainer","undefined","get","label","MemoizedTabBar","StyleSheet","create","flexDirection","flexWrap"],"sources":["TabBar.tsx"],"sourcesContent":["import React from 'react'\nimport {\n  StyleSheet,\n  useWindowDimensions,\n  LayoutChangeEvent,\n} from 'react-native'\nimport Animated, {\n  cancelAnimation,\n  scrollTo,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withTiming,\n} from 'react-native-reanimated'\n\nimport { TabName } from '../types'\nimport {\n  Indicator,\n  IndicatorComponent as _IndicatorComponent,\n} from './Indicator'\nimport { MaterialTabItem } from './TabItem'\nimport { MaterialTabBarProps, ItemLayout } from './types'\n\nexport const TABBAR_HEIGHT = 48\n\n/**\n * Basic usage looks like this:\n *\n * ```tsx\n * <Tabs.Container\n *   ...\n *   TabBarComponent={(props) => (\n *     <MaterialTabBar\n *       {...props}\n *       activeColor=\"red\"\n *       inactiveColor=\"yellow\"\n *       inactiveOpacity={1}\n *       labelStyle={{ fontSize: 14 }}\n *     />\n *   )}\n * >\n *   {...}\n * </Tabs.Container>\n * ```\n */\nconst MaterialTabBar = <T extends TabName = TabName>({\n  tabNames,\n  indexDecimal,\n  scrollEnabled = false,\n  indicatorStyle,\n  index,\n  TabItemComponent = MaterialTabItem,\n  IndicatorComponent = _IndicatorComponent,\n  getLabelText = (name) => String(name).toUpperCase(),\n  onTabPress,\n  style,\n  tabProps,\n  contentContainerStyle,\n  labelStyle,\n  inactiveColor,\n  activeColor,\n  tabStyle,\n  width: customWidth,\n  keepActiveTabCentered,\n}: MaterialTabBarProps<T>): React.ReactElement => {\n  const tabBarRef = useAnimatedRef<Animated.ScrollView>()\n  const windowWidth = useWindowDimensions().width\n  const width = customWidth ?? windowWidth\n  const isFirstRender = React.useRef(true)\n  const itemLayoutGathering = React.useRef(new Map<T, ItemLayout>())\n\n  const tabsOffset = useSharedValue(0)\n  const isScrolling = useSharedValue(false)\n\n  const nTabs = tabNames.length\n\n  const [itemsLayout, setItemsLayout] = React.useState<ItemLayout[]>(\n    scrollEnabled\n      ? []\n      : tabNames.map((_, i) => {\n          const tabWidth = width / nTabs\n          return { width: tabWidth, x: i * tabWidth }\n        })\n  )\n\n  React.useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n    } else if (!scrollEnabled) {\n      // update items width on window resizing\n      const tabWidth = width / nTabs\n      setItemsLayout(\n        tabNames.map((_, i) => {\n          return { width: tabWidth, x: i * tabWidth }\n        })\n      )\n    }\n  }, [scrollEnabled, nTabs, tabNames, width])\n\n  const onTabItemLayout = (event: LayoutChangeEvent, name: T) => {\n    if (scrollEnabled) {\n      if (!event.nativeEvent?.layout) return\n      const { width, x } = event.nativeEvent.layout\n\n      itemLayoutGathering.current.set(name, {\n        width,\n        x,\n      })\n\n      // pick out the layouts for the tabs we know about (in case they changed dynamically)\n      const layout = Array.from(itemLayoutGathering.current.entries())\n        .filter(([tabName]) => tabNames.includes(tabName))\n        .map(([, layout]) => layout)\n        .sort((a, b) => a.x - b.x)\n\n      if (layout.length === tabNames.length) {\n        setItemsLayout(layout)\n      }\n    }\n  }\n\n  const cancelNextScrollSync = useSharedValue(index.value)\n\n  const onScroll = useAnimatedScrollHandler(\n    {\n      onScroll: (event) => {\n        tabsOffset.value = event.contentOffset.x\n      },\n      onBeginDrag: () => {\n        isScrolling.value = true\n        cancelNextScrollSync.value = index.value\n      },\n      onMomentumEnd: () => {\n        isScrolling.value = false\n      },\n    },\n    []\n  )\n\n  const currentIndexToSync = useSharedValue(index.value)\n  const targetIndexToSync = useSharedValue(index.value)\n\n  useAnimatedReaction(\n    () => {\n      return index.value\n    },\n    (nextIndex) => {\n      if (scrollEnabled) {\n        cancelAnimation(currentIndexToSync)\n        targetIndexToSync.value = nextIndex\n        currentIndexToSync.value = withTiming(nextIndex)\n      }\n    },\n    [scrollEnabled]\n  )\n\n  useAnimatedReaction(\n    () => {\n      return currentIndexToSync.value === targetIndexToSync.value\n    },\n    (canSync) => {\n      if (\n        canSync &&\n        scrollEnabled &&\n        itemsLayout.length === nTabs &&\n        itemsLayout[index.value]\n      ) {\n        const halfTab = itemsLayout[index.value].width / 2\n        const offset = itemsLayout[index.value].x\n        if (\n          keepActiveTabCentered ||\n          offset < tabsOffset.value ||\n          offset > tabsOffset.value + width - 2 * halfTab\n        ) {\n          scrollTo(tabBarRef, offset - width / 2 + halfTab, 0, true)\n        }\n      }\n    },\n    [scrollEnabled, itemsLayout, nTabs]\n  )\n  return (\n    <Animated.ScrollView\n      ref={tabBarRef}\n      horizontal\n      style={style}\n      contentContainerStyle={[\n        styles.contentContainer,\n        !scrollEnabled && { width },\n        contentContainerStyle,\n      ]}\n      keyboardShouldPersistTaps=\"handled\"\n      bounces={false}\n      alwaysBounceHorizontal={false}\n      scrollsToTop={false}\n      showsHorizontalScrollIndicator={false}\n      automaticallyAdjustContentInsets={false}\n      overScrollMode=\"never\"\n      scrollEnabled={scrollEnabled}\n      onScroll={scrollEnabled ? onScroll : undefined}\n      scrollEventThrottle={16}\n    >\n      {tabNames.map((name, i) => {\n        return (\n          <TabItemComponent\n            key={name}\n            index={i}\n            name={name}\n            label={tabProps.get(name)?.label || getLabelText(name)}\n            onPress={onTabPress}\n            onLayout={\n              scrollEnabled\n                ? (event) => onTabItemLayout(event, name)\n                : undefined\n            }\n            scrollEnabled={scrollEnabled}\n            indexDecimal={indexDecimal}\n            labelStyle={labelStyle}\n            activeColor={activeColor}\n            inactiveColor={inactiveColor}\n            style={tabStyle}\n          />\n        )\n      })}\n      {itemsLayout.length === nTabs && (\n        <Indicator\n          children={IndicatorComponent}\n          indexDecimal={indexDecimal}\n          itemsLayout={itemsLayout}\n          fadeIn={scrollEnabled}\n          style={indicatorStyle}\n        />\n      )}\n    </Animated.ScrollView>\n  )\n}\n\nconst MemoizedTabBar = MaterialTabBar\n\nexport { MemoizedTabBar as MaterialTabBar }\n\nconst styles = StyleSheet.create({\n  contentContainer: {\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n  },\n})\n"],"mappings":"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"}